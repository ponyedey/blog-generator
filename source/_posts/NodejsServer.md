---
layout: node.js
title: Server
date: 2017-10-17 19:02:12
tags:
---
- HTTP 协议的底层其实是由 TCP 协议和 IP 协议（简称 TCP/IP）构建的。
# TCP 传输控制协议（Transmission Control Protocol）
面试的时候顶多会问两个相关问题，去看博客了解一下即可：
1. [TCP 和 UDP 的区别是什么](https://www.nowcoder.com/questionTerminal/63c8b45c91a544bd8febc1f1ff02e3b5?toCommentId=73766)
- 简答：TCP 可靠、面向连接、相对 UDP 较慢；UDP 不可靠，不面向连接、相对 TCP 较快。搞定。
2. [TCP 的三次握手指的是什么](https://github.com/jawil/blog/issues/14)
- 简答：每次建立连接前，客户端和服务端之前都要先进行三次对话才开始正式传输内容，三次对话大概是这样的：
```
1. 客户端：我要连接你了，可以吗
 2. 服务端：嗯，我准备好了，连接我吧
 3. 客户端：那我连接你咯。
 4. 开始后面步骤
```

上面内容足以应付前端面试中关于 TCP 的考题 :)
- 如果你想更了解 TCP 可以看 [此文](http://www.ruanyifeng.com/blog/2017/06/tcp-protocol.html)，也可以买一本《TCP/IP 详解（卷一）》（共三卷，先只买一卷即可）。
- 不过再强调一遍，这不是前端的内容，以后的课程中我也不会再对 TCP 有任何涉及，你只需稍微了解一下 TCP 即可。

# IP 网络协议（英语：Internet Protocol）
- 看写代码啦的Node.js Server文章复习

# 端口
- 你想要访问一个设备（前提是你使用的是 TCP 或 UDP 协议。还记得吗，HTTP 就使用了 TCP），只指定 IP 是不够的，还必须指定端口（Port）。

- 端口其实就是一个编号，并不是一种硬件。

- 一个服务器（硬件）不一定只提供一种服务，比如一个服务器既提供 HTTP 服务，又提供 FTP 服务，还提供 SMTP 服务（邮件服务），那么只用一个 IP 是无法告诉服务器你想要使用哪种服务。

- 所以这里有一个重要的原则：一个端口对应一个服务。
比如：
1. 要提供 HTTP 服务你最好使用 80 端口（能不能使用别的端口？可以，不过不建议你违反约定）
2. 要提供 HTTPS 服务你最好使用 443 端口（能不能使用别的端口？可以，不过不建议你违反约定）
3. 要提供 FTP 服务你最好使用 21 端口（能不能使用别的端口？可以，不过不建议你违反约定）

## 问题1：我怎么知道用什么端口
- wiki去查每个端口的意义吧[维基百科](https://zh.wikipedia.org/wiki/TCP/UDP%E7%AB%AF%E5%8F%A3%E5%88%97%E8%A1%A8#0.E5.88.B01023.E5.8F.B7.E7.AB.AF.E5.8F.A3)

## 问题2：有多少个端口
- 每个机器一共有 65535（2的16次方减1）个端口（这是协议规定的）。不过这些端口的使用由一些规定

1. 0 到 1023（2的10次方减1）号端口是留给系统使用的，你只有拥有了管理员权限后，才能使用这 1024 个端口。
2. 其他端口可以给普通用户使用
3. 如果一个端口正在提供服务，也就是被占用了，那么就不能再使用这个端口。除非你先停掉正在占用这个端口的服务。以后你们会经常遇到这个问题。

# 总结
简单粗暴
1. 上面都是 TCP/IP 相关的知识，如果你记不住，就记住下面这句话：
使用 HTTP 协议访问另一个 IP 时，比如同时提供 IP 和端口号，缺一不可。
2. 那么问题来了，我访问 [http://qq.com](http://qq.com/) 时并没有提供端口号，为什么我依然可以访问
答：因为浏览器帮你加了默认端口号 80。

# 搭建一个简易的server
- 相应的js文件在我的github repo中，仓库名为demo-server
特别注意：
- 中断服务器用Ctrl + C 
- 运行服务器时要输入端口号
- %表示结尾，不爽可以加一个\n
- 后缀是废话，文件内容识别是有content type保证的
- HTTP路径不是文件路径！/xxx.html不一定对应xxx.html文件

详细可以看写代码啦的文章以及自己github上上传的文件